scalar DateTime
scalar StripeObject

interface Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime
}

type Item implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  name:         String!
  description:  String
  enabled:      Boolean!
  isBadge:      Boolean!
  
  options:      [ItemOptionType!]
  prices:       [ItemPrice!]!
}

type ItemOptionType implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  key:          String!
  valueType:    String!
}

type ItemOption implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  optionType:   ItemOptionType!
  values:       [String!]!
}

type ItemPrice implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  price:        Int!
  beforeDate:   DateTime!
  afterDate:    DateTime!
}

type Invoice implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  cardToken:    String
  chargeToken:  String
  cardData:     StripeObject
  chargeData:   StripeObject

  items:        [InvoiceItem!]!
}

type InvoiceItem implements Postgresql {
  id:           ID!
  createdAt:    DateTime!
  updatedAt:    DateTime!
  deletedAt:    DateTime

  item:         Item!
  options:      [ItemOption!]
  price:        ItemPrice!
}

type Query {
  items: [Item!]!
  invoices: [Invoice!]!
}

input NewItem {
  name:         String!
  description:  String
  prices:       [NewItemPrice!]!
}

input NewItemPrice {
  price:        Int!
  beforeDate:   DateTime!
  afterDate:    DateTime!
}

type Mutation {
  createItem(input: NewItem!) : Item!
  updateItem(id: ID!, input: NewItem!) : Item!
}